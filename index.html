<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E2</title>

    <style>
        canvas{
            border-style: solid;
            border-width: 1px;
            border-color: black;
        }
    </style>
</head>
<body>
    <center>
        <canvas id="mycanvas" width="500" height="500">
            Si puedes ver esto, tu navegador no soporta canvas.
        </canvas>

        <img src="./assets/ordenador.png" id="imagen" style="display: none;">

    </center>

    <script type="text/javascript">
        
        
        var canvas = document.getElementById('mycanvas');
        var ctx = null;
        var color = "rgba(0, 0, 200, 0.5)";
        var figura = 1;
        var isPressed = false;
        var globalX=230;
        var globalY=230;
        var speed = 5;

        // paint(ctx);

        function paint(ctx){
            ctx.fillStyle = "white";
			ctx.fillRect(0,0,500,500);

			ctx.fillStyle = "red";
			ctx.fillRect(globalX,globalY,50,50);
            /*var canvas = document.getElementById('mycanvas');

            if(canvas.getContext){

                var ctx = canvas.getContext('2d');

                ctx.fillStyle = "rgba(0, 0, 200, 0.5)";
                ctx.fillRect(20,20,50,50);

                ctx.fillStyle = "rgba(200, 0, 9)";
                ctx.fillRect(60,60,50,50);

                ctx.fillStyle = "rgba(255, 0, 255, 0.5)";
                ctx.fillRect(100,100,50,50);

                ctx.beginPath();
                ctx.moveTo(250,250);
                ctx.lineTo(350,350);
                ctx.closePath();
                ctx.stroke();

                ctx.beginPath();
                ctx.moveTo(400,400);
                ctx.lineTo(320,390);
                ctx.lineTo(290,310);
                ctx.lineTo(400,400);
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath()
                ctx.arc(350,70,40,0,2 * Math.PI);
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath()
                ctx.arc(440,70,40,0,2 * Math.PI);
                ctx.fillStyle = "red";
                ctx.fill();
                ctx.closePath();


                ctx.font = "40px Arial"
                ctx.fillText("Hola Mundo",50,350);
                ctx.strokeText("Hola mundo",50,390);

                var grd = ctx.createLinearGradient(75, 50, 40, 100, 60, 100);
                grd.addColorStop(0, "yellow");
                grd.addColorStop(1, "purple");

                ctx.fillStyle = grd;
                ctx.fillRect(170, 180, 150, 60);

                var grd = ctx.createRadialGradient(75, 50, 5, 90, 60, 100);
                grd.addColorStop(0, "red");
                grd.addColorStop(1, "white");

                ctx.fillStyle = grd;
                ctx.fillRect(10, 10, 150, 80);

                var img = document.getElementById('imagen');
                ctx.drawImage(img,300,380);


            }*/ 
        }

        function run(){
            canvas = document.getElementById('mycanvas')
            ctx = canvas.getContext('2d');

            paint(ctx);

            canvas.addEventListener('click', function(evt){
                //console.log(evt);

                ctx.fillStyle = color;
                if(figura==1){
                    ctx.beginPath();
                    ctx.arc(evt.layerX, evt.layerY, 40,0,2 * Math.PI);
                    ctx.fill();
                    ctx.stroke;
                    ctx.closePath();
                }else{
                    ctx.fillRect(evt.layerX-25,evt.layerY-25,50,50);
                    ctx.strokeRect(evt.layerX-25,evt.layerY-25,50,50);
                }
            

            },false);

            canvas.addEventListener('mouseover',function(evt){
                //console.log(evt);
                //color = "#"+Math.floor(Math.random()*16777215).toString(16);

                color = getRandomColor(); 

            },false)

            canvas.addEventListener('mouseout',function(evt){
                figura = (figura==1)?2:1;
            },false)

            canvas.addEventListener('mousemove',function(evt){
                
                if(isPressed){
                    ctx.fillStyle = "black";
                    ctx.fillRect(evt.layerX-1.5,evt.layerY-1.5,3,3);
                }
                
            },false);

            canvas.addEventListener('mauseup',function(evt){
                
                isPressed = false;

            },false);

            canvas.addEventListener('mausedown',function(evt){
                
                isPressed = true;

            },false);

        }
        
        document.addEventListener('keydown',function(evt){
            console.log(evt.keyCode);
            
            if (evt.keyCode == 39 || evt.keyCode == 68) {
                globalX += speed;
            }
            
            if (evt.keyCode == 37 || evt.keyCode == 65) {
                globalX -= speed;
            }
            
            if (evt.keyCode == 38 || evt.keyCode == 87) {
                globalY -= speed;
            }
            
            if (evt.keyCode == 40 || evt.keyCode == 83) {
                globalY += speed;
            }
            
            if (evt.keyCode == 32) {
                speed += 10;
            }
            paint(ctx);
            
            
        },false);
        
        function getRandomColor(){
            var trans = '0.5';
            var color = 'rgba(';
            for(var i = 0; i<3; i++){
                color += Math.floor(Math.random()*255) + ',';
            }
            color += trans + ')';
            return color;
        }

        window.addEventListener('load',run(),false);
        
        </script>
</body>
</html>